<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>使用 Github actions 向 Cloudflare Pages 上传网页</title>
    <url>/CFPages/</url>
    <content><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><ul>
<li><ol>
<li>简洁</li>
</ol>
</li>
<li><ol start="2">
<li>提供搜索栏</li>
</ol>
</li>
<li><ol start="3">
<li>无广告</li>
</ol>
</li>
</ul>
<h2 id="代码部署"><a href="#代码部署" class="headerlink" title="代码部署"></a>代码部署</h2><span id="more"></span>

<ul>
<li><ol>
<li>整体流程：</li>
</ol>
<ul>
<li>代码部署再 GitHub 私有库中，使用 Github Actions 在触发 push 到 main 分支时，启动 workflows 将 html 文件推送到 Cloudflare Pages 项目中。</li>
</ul>
</li>
<li><ol start="2">
<li>事前准备：</li>
</ol>
<ul>
<li><ol>
<li>Github 账户</li>
</ol>
</li>
<li><ol start="2">
<li>Cloud flare 账户</li>
</ol>
</li>
<li><ol start="3">
<li>Cloud flare 有 Cloud flare Pages 编辑权限的 Token</li>
</ol>
</li>
<li><ol start="4">
<li>Github 私有仓库一个</li>
</ol>
</li>
<li><ol start="5">
<li>准备好的 HTML 项目</li>
</ol>
</li>
</ul>
</li>
<li><ol start="3">
<li>实现：</li>
</ol>
<ul>
<li><ol>
<li>向 Github 仓库中添加 3 个变量 <kbd>CF_TOKEN</kbd><kbd>CF_ID</kbd><kbd>CF_NAME</kbd><br>这三个变量来源分别为： - CF_ID: 在访问<a href="https://dash.cloudflare.com/">cloudflare</a>时，浏览器网址栏形如：<a href="https://dash.cloudflare.com/******%E3%80%82%E5%85%B6%E4%B8%AD**/*/">https://dash.cloudflare.com/******。其中**\*\</a>*** 就是你的 ID。<br> <img src="/images/CF_ID.png" alt="CF_ID">  <ul>
<li>CF_TOKEN: 登录成功后，在<kbd>个人资料</kbd><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg></mjx-container><kbd>API 令牌</kbd><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="1.181ex" role="img" focusable="false" viewBox="0 -511 1000 522"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g></g></g></svg></mjx-container><kbd>创建令牌</kbd>中创建一个拥有 Cloud flare Pages 编辑权限的 Token。<br><img src="/images/CF_TOKEN1.png" alt="CF_TOKEN"><br> <img src="/images/CF_TOKEN2.png" alt="CF_TOKEN"><br> <img src="/images/CF_TOKEN3.png" alt="CF_TOKEN">  </li>
<li>CF_NAME: <a href="https://pages.cloudflare.com/">Cloudflare Pages</a> 进入 Cloud flare Pages 页面创建一个 Pages 项目<br> <img src="/images/CF_NAME1.png" alt="CF_NAME"><br> 选择上传资产<br> <img src="/images/CF_NAME2.png" alt="CF_NAME"><br> 输入项目名，这个就是 CF_NAME<br><img src="/images/CF_NAME3.png" alt="CF_NAME"><br>这时，Cloud flare 已经将 Pages 项目创建好了。已经可以接受 Github actions push 代码过来显示了。</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li><p>在本地 git clone 下来你的仓库。<br>创建.github/workflows/${ Your File Name }.yml</p>
<pre><code>    name: 部署 cloudflare Pages 个人落地页
    on:
    push:
        branches:
        - main

    jobs:
        publish:
            runs-on: ubuntu-latest
            permissions:
                contents: read
                deployments: write
            name: Publish to Cloudflare Pages
            steps:
                - name: Checkout
                uses: actions/checkout@v3

                    # Run a build step here if your project requires

                - name: Publish to Cloudflare Pages
                uses: cloudflare/pages-action@v1
                with:
                    apiToken: ${{ secrets.CF_TOKEN }}
                    accountId: ${{ secrets.CF_ID }}
                    projectName: ${{ secrets.CF_NAME }}
                    directory: ***
                    wranglerVersion: '3'
</code></pre>
<p><strong><em>注意：将</em></strong> <kbd>directory:</kbd>，<kbd>branches:</kbd><strong><em>部分根据实际情况更换</em></strong></p>
</li>
</ol>
</li>
<li><ol start="3">
<li>最后将本地仓库 push 到 GitHub 中就完成了。</li>
</ol>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Cloudflare</category>
      </categories>
      <tags>
        <tag>Cloudflare</tag>
        <tag>Cloudflare Page</tag>
        <tag>Github Action</tag>
        <tag>Github</tag>
      </tags>
  </entry>
</search>
